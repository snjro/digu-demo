var m=Object.defineProperty;var f=(a,e,t)=>e in a?m(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var c=(a,e,t)=>(f(a,typeof e!="symbol"?e+"":e,t),t);import{d as l,l as g}from"./CommonItemMember.CRanTEMj.js";import{d as D,b as S,D as h,P as p,a as i}from"./dbBase.BEbG6e0G.js";import{e as b,g as y,s as E}from"./storeSyncStatus.CLF-ij8b.js";import"./storeRpcSettings.CTg7fdRt.js";class x extends D{constructor(t){const n=l(t),o=b(n.contracts),s=Object.values(t);s.unshift(S.secondNames.eventLog);super(s);c(this,"versionIdentifier");const u=this.getSchemaDefinition(o);this.version(h.EventLog).stores(u),this.on("populate",async d=>{await this.addInitialData(d,o)}),this.versionIdentifier=t}getSchemaDefinition(t){const n={},o=g(t);for(const s of o)n[s]=p;return n[i.EventLog.syncStatus]="name",n}async addInitialData(t,n){const o=n.map(s=>y(s));await t.table(i.EventLog.syncStatus).bulkAdd(o)}}function N(a,e){const t=10**e;return Math.round(a*t)/t}function A(a,e,t){const n=t-a,o=e-a,s=N(n*100/o,3);return isNaN(s)||s<0?0:s}function B(a){return a>=99.95?a.toFixed(0):a.toFixed(1)}const r=i.EventLog.syncStatus;async function v(a,e,t){const n={...a.versionIdentifier,contractName:e};await a.transaction("rw",a.table(r),async()=>{await a.table(r).update(e,t)}).then(()=>{E.updateState(n,t)})}async function O(a,e,t,n){await v(a,e,{[t]:n})}export{x as D,A as a,B as g,O as u};
